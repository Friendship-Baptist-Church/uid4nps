<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_51) on Fri Sep 04 16:42:51 CEST 2015 -->
<title>userid4nps</title>
<meta name="date" content="2015-09-04">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="userid4nps";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../uid4nps/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/userid4nps.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../uid4nps/PanosXlmResponseParse.html" title="class in uid4nps"><span class="strong">Prev Class</span></a></li>
<li><a href="../uid4nps/UseridNpsDtsParser.html" title="class in uid4nps"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?uid4nps/userid4nps.html" target="_top">Frames</a></li>
<li><a href="userid4nps.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">uid4nps</div>
<h2 title="Class userid4nps" class="title">Class userid4nps</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>uid4nps.userid4nps</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">userid4nps</span>
extends java.lang.Object</pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#configFile">configFile</a></strong></code>
<div class="block">Path to configuration path.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.HashMap&lt;java.nio.file.Path,java.lang.Long&gt;</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#currentFileSizeDB">currentFileSizeDB</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.nio.file.Path</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#currentNpsLogFile">currentNpsLogFile</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#currentState">currentState</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#defaultDomain">defaultDomain</a></strong></code>
<div class="block">Domain name that will be added to all valid accounting records that do not have
 a valid domain name.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static boolean</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#dynAddressFeature">dynAddressFeature</a></strong></code>
<div class="block">Boolean attribute to user PANOS 6.0 Tagged Dynamic Address features.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.nio.channels.FileChannel</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fcNpsLogFile">fcNpsLogFile</a></strong></code>
<div class="block">This field will point to the current NPS log file being used</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.nio.file.FileSystem</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fs">fs</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fw1PanosKey">fw1PanosKey</a></strong></code>
<div class="block">API key for the first PANOS cluster member.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fw1Url">fw1Url</a></strong></code>
<div class="block">URL path to reach the first PANOS cluster member.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fw2PanosKey">fw2PanosKey</a></strong></code>
<div class="block">API key for the second PANOS cluster member.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fw2Url">fw2Url</a></strong></code>
<div class="block">URL path to reach the second PANOS cluster member.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.io.BufferedReader</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#in">in</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#includePattern">includePattern</a></strong></code>
<div class="block">This pattern will be matched against all NPS records.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.Boolean</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#keepRunning">keepRunning</a></strong></code>
<div class="block">Field that, while true, will keep the FSM running (<a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a>)
 Calling the class' <a href="../uid4nps/userid4nps.html#stop(java.lang.String[])"><code>stop(java.lang.String[])</code></a> method clears the value an eventually will break the main loop.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.logging.Logger</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#logHandler">logHandler</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.util.logging.Level</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#logLevel">logLevel</a></strong></code>
<div class="block">It equals the "logLevel" parameter in the configuration file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#maxPendingEntries">maxPendingEntries</a></strong></code>
<div class="block">How many user-id requests we may buffer before sending all of them to the PANOS device.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.nio.file.DirectoryStream&lt;java.nio.file.Path&gt;</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#npsDirStream">npsDirStream</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#npsLogDir">npsLogDir</a></strong></code>
<div class="block">Path to the directory where the DTS-compliant log entries from the NPS are stored.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.nio.file.Path</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#npsLogPath">npsLogPath</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.HashMap&lt;java.nio.file.Path,java.lang.Long&gt;</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#oldFileSizeDB">oldFileSizeDB</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#outputLogFile">outputLogFile</a></strong></code>
<div class="block">Path to the file that will host the log messages we generate.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="../uid4nps/UseridPanosInterface.html" title="class in uid4nps">UseridPanosInterface</a></code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#paInterface">paInterface</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#panosBufferedTime">panosBufferedTime</a></strong></code>
<div class="block">How many milliseconds we'll keep user-id requests in the buffer before we flush
 the buffer to the PANOS device.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static <a href="../uid4nps/UseridNpsDtsParser.html" title="class in uid4nps">UseridNpsDtsParser</a></code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#parser">parser</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#readlineTries">readlineTries</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static java.util.ArrayList&lt;java.nio.file.Path&gt;</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#unknownFileArray">unknownFileArray</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#useridTimeout">useridTimeout</a></strong></code>
<div class="block">User-ID timeout (in minutes) we'll use when pushing entries to the PANOS device.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#vsys">vsys</a></strong></code>
<div class="block">Target vsys for the PANOS user-id messages.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#xmlElement">xmlElement</a></strong></code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../uid4nps/userid4nps.html#userid4nps()">userid4nps</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#fsm(int)">fsm</a></strong>(int&nbsp;trans)</code>
<div class="block">Main loop.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#init()">init</a></strong>()</code>
<div class="block">Initializes all class fields either from parsing the configuration file passed as command line argument
 or by initializing its values to their default value.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#lineProc()">lineProc</a></strong>()</code>
<div class="block">A new line has been made available at the end of the <a href="../uid4nps/userid4nps.html#fcNpsLogFile"><code>fcNpsLogFile</code></a> log file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#main(java.lang.String[])">main</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Main method.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#start(java.lang.String[])">start</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">The method starting the application.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#stop(java.lang.String[])">stop</a></strong>(java.lang.String[]&nbsp;args)</code>
<div class="block">Clears the <a href="../uid4nps/userid4nps.html#keepRunning"><code>keepRunning</code></a> flag so <a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a> can gracefully end</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected static int</code></td>
<td class="colLast"><code><strong><a href="../uid4nps/userid4nps.html#tryNewFile(java.nio.file.Path)">tryNewFile</a></strong>(java.nio.file.Path&nbsp;oldFile)</code>
<div class="block">After ten unsuccessful consecutive tries to read a new line from the <a href="../uid4nps/userid4nps.html#fcNpsLogFile"><code>fcNpsLogFile</code></a>
 we'll review the <a href="../uid4nps/userid4nps.html#npsLogDir"><code>npsLogDir</code></a> directory to see if NPS has rolled up to a new
 log file.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="configFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>configFile</h4>
<pre>protected static&nbsp;java.lang.String configFile</pre>
<div class="block">Path to configuration path. Its value must be passed from the command line as "-config=<configurationFile>"</div>
</li>
</ul>
<a name="currentFileSizeDB">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>currentFileSizeDB</h4>
<pre>private static&nbsp;java.util.HashMap&lt;java.nio.file.Path,java.lang.Long&gt; currentFileSizeDB</pre>
</li>
</ul>
<a name="currentNpsLogFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>currentNpsLogFile</h4>
<pre>private static&nbsp;java.nio.file.Path currentNpsLogFile</pre>
</li>
</ul>
<a name="currentState">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>currentState</h4>
<pre>private static&nbsp;int currentState</pre>
</li>
</ul>
<a name="defaultDomain">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>defaultDomain</h4>
<pre>protected static&nbsp;java.lang.String defaultDomain</pre>
<div class="block">Domain name that will be added to all valid accounting records that do not have
 a valid domain name. It equals the "defaultDomain" in the configuration file and defaults to "corppro"</div>
</li>
</ul>
<a name="dynAddressFeature">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>dynAddressFeature</h4>
<pre>protected static&nbsp;boolean dynAddressFeature</pre>
<div class="block">Boolean attribute to user PANOS 6.0 Tagged Dynamic Address features. If enabled we'll send dynamic address
 objects tagged with the string provided by the NAS device in the DTS field named "NAS-Identifier"</div>
</li>
</ul>
<a name="fcNpsLogFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fcNpsLogFile</h4>
<pre>protected static&nbsp;java.nio.channels.FileChannel fcNpsLogFile</pre>
<div class="block">This field will point to the current NPS log file being used</div>
</li>
</ul>
<a name="fs">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fs</h4>
<pre>private static&nbsp;java.nio.file.FileSystem fs</pre>
</li>
</ul>
<a name="fw1PanosKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fw1PanosKey</h4>
<pre>protected static&nbsp;java.lang.String fw1PanosKey</pre>
<div class="block">API key for the first PANOS cluster member. It can be obtained with the keygen PANOS API type.
 (consult PANOS API reference guide for more information).
 It equals the "fw1PanosKey" in the configuration file and defaults to "0000"</div>
</li>
</ul>
<a name="fw1Url">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fw1Url</h4>
<pre>protected static&nbsp;java.lang.String fw1Url</pre>
<div class="block">URL path to reach the first PANOS cluster member.
 It equals the "fw1Url" in the configuration file and defaults to "https://192.168.1.1".
 Be aware that the colon ":" char must be escaped in the configuration file</div>
</li>
</ul>
<a name="fw2PanosKey">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fw2PanosKey</h4>
<pre>protected static&nbsp;java.lang.String fw2PanosKey</pre>
<div class="block">API key for the second PANOS cluster member. It can be obtained with the keygen PANOS API type.
 It equals the "fw2PanosKey" in the configuration file and defaults to "0000"</div>
</li>
</ul>
<a name="fw2Url">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fw2Url</h4>
<pre>protected static&nbsp;java.lang.String fw2Url</pre>
<div class="block">URL path to reach the second PANOS cluster member.
 It equals the "fw2Url" in the configuration file and defaults to "https://192.168.1.2"
 It is save to use the same value as "fw1Url" in single node scenarios or when using an
 inband management interface for both cluster members</div>
</li>
</ul>
<a name="in">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>in</h4>
<pre>private static&nbsp;java.io.BufferedReader in</pre>
</li>
</ul>
<a name="includePattern">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>includePattern</h4>
<pre>protected static&nbsp;java.lang.String includePattern</pre>
<div class="block">This pattern will be matched against all NPS records. Only the ones matching this pattern will be included
 for processing</div>
</li>
</ul>
<a name="keepRunning">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>keepRunning</h4>
<pre>protected static&nbsp;java.lang.Boolean keepRunning</pre>
<div class="block">Field that, while true, will keep the FSM running (<a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a>)
 Calling the class' <a href="../uid4nps/userid4nps.html#stop(java.lang.String[])"><code>stop(java.lang.String[])</code></a> method clears the value an eventually will break the main loop.</div>
</li>
</ul>
<a name="logHandler">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logHandler</h4>
<pre>private static&nbsp;java.util.logging.Logger logHandler</pre>
</li>
</ul>
<a name="logLevel">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logLevel</h4>
<pre>protected static&nbsp;java.util.logging.Level logLevel</pre>
<div class="block">It equals the "logLevel" parameter in the configuration file.
 Use INFO for normal operation, FINE for tracing and FINEST for debugging</div>
</li>
</ul>
<a name="maxPendingEntries">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxPendingEntries</h4>
<pre>protected static&nbsp;int maxPendingEntries</pre>
<div class="block">How many user-id requests we may buffer before sending all of them to the PANOS device.
 It equals the "maxPendingEntries" in the configuration file and defaults to 100</div>
</li>
</ul>
<a name="npsDirStream">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>npsDirStream</h4>
<pre>private static&nbsp;java.nio.file.DirectoryStream&lt;java.nio.file.Path&gt; npsDirStream</pre>
</li>
</ul>
<a name="npsLogDir">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>npsLogDir</h4>
<pre>protected static&nbsp;java.lang.String npsLogDir</pre>
<div class="block">Path to the directory where the DTS-compliant log entries from the NPS are stored.
 This directory must be used EXCLUSIVELLY for NPS DTS-compliant file storage.
 The log files must have a ".log" extension.
 It equals the "npsLogDir" in the configuration file and defaults to "C:/Windows/System32/LogFiles"</div>
</li>
</ul>
<a name="npsLogPath">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>npsLogPath</h4>
<pre>private static&nbsp;java.nio.file.Path npsLogPath</pre>
</li>
</ul>
<a name="oldFileSizeDB">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>oldFileSizeDB</h4>
<pre>private static&nbsp;java.util.HashMap&lt;java.nio.file.Path,java.lang.Long&gt; oldFileSizeDB</pre>
</li>
</ul>
<a name="outputLogFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>outputLogFile</h4>
<pre>protected static&nbsp;java.lang.String outputLogFile</pre>
<div class="block">Path to the file that will host the log messages we generate. It equals the "outputLogFile"
 parameter in the configuration file and defaults to "userid4nps.log"</div>
</li>
</ul>
<a name="paInterface">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>paInterface</h4>
<pre>private static&nbsp;<a href="../uid4nps/UseridPanosInterface.html" title="class in uid4nps">UseridPanosInterface</a> paInterface</pre>
</li>
</ul>
<a name="panosBufferedTime">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>panosBufferedTime</h4>
<pre>protected static&nbsp;int panosBufferedTime</pre>
<div class="block">How many milliseconds we'll keep user-id requests in the buffer before we flush
 the buffer to the PANOS device.
 It equals the "panosBufferedTime" in the configuration file and defaults to 2000</div>
</li>
</ul>
<a name="parser">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>parser</h4>
<pre>private static&nbsp;<a href="../uid4nps/UseridNpsDtsParser.html" title="class in uid4nps">UseridNpsDtsParser</a> parser</pre>
</li>
</ul>
<a name="readlineTries">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readlineTries</h4>
<pre>private static&nbsp;int readlineTries</pre>
</li>
</ul>
<a name="unknownFileArray">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unknownFileArray</h4>
<pre>private static&nbsp;java.util.ArrayList&lt;java.nio.file.Path&gt; unknownFileArray</pre>
</li>
</ul>
<a name="useridTimeout">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>useridTimeout</h4>
<pre>protected static&nbsp;int useridTimeout</pre>
<div class="block">User-ID timeout (in minutes) we'll use when pushing entries to the PANOS device.
 It is safe to use a long timeout as we'll clear the entry provided we receive an
 Accounting-Stop message for this user.
 It equals the "useridTimeout" in the configuration file and defaults to 1440</div>
</li>
</ul>
<a name="vsys">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>vsys</h4>
<pre>protected static&nbsp;java.lang.String vsys</pre>
<div class="block">Target vsys for the PANOS user-id messages. If vsys = "none" we'll not send the vsys attribute
 in the PANOS call. Otherwise we'll append vsys=<vsys> in the attribute chain</div>
</li>
</ul>
<a name="xmlElement">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>xmlElement</h4>
<pre>private static&nbsp;java.lang.String xmlElement</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="userid4nps()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>userid4nps</h4>
<pre>public&nbsp;userid4nps()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="fsm(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fsm</h4>
<pre>protected static&nbsp;void&nbsp;fsm(int&nbsp;trans)
                   throws java.io.IOException</pre>
<div class="block">Main loop. Will keep running while <a href="../uid4nps/userid4nps.html#keepRunning"><code>keepRunning</code></a> is set to true.
 Calling the class' <a href="../uid4nps/userid4nps.html#stop(java.lang.String[])"><code>stop(java.lang.String[])</code></a> method will set <a href="../uid4nps/userid4nps.html#keepRunning"><code>keepRunning</code></a> to FALSE and
 will allow the FSM to gracefull terminate</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>trans</code> - a valid FSM transition</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="init()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>protected static&nbsp;void&nbsp;init()
                    throws java.security.NoSuchAlgorithmException,
                           java.security.KeyManagementException,
                           java.io.IOException,
                           javax.xml.parsers.ParserConfigurationException,
                           org.xml.sax.SAXException,
                           java.lang.InterruptedException</pre>
<div class="block">Initializes all class fields either from parsing the configuration file passed as command line argument
 or by initializing its values to their default value.
 In case the configuration file doesn't exist it will be created with default values (template).
 It is called from within the <a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a> when entering the INIT state.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.security.KeyManagementException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>java.lang.InterruptedException</code></dd></dl>
</li>
</ul>
<a name="lineProc()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lineProc</h4>
<pre>protected static&nbsp;void&nbsp;lineProc()
                        throws java.io.IOException</pre>
<div class="block">A new line has been made available at the end of the <a href="../uid4nps/userid4nps.html#fcNpsLogFile"><code>fcNpsLogFile</code></a> log file.
 We read the line from the file and call the XML parser.
 It is called from within the <a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a> each time it enters in the LINEPROC state.</div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="main(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>main</h4>
<pre>public static&nbsp;void&nbsp;main(java.lang.String[]&nbsp;args)
                 throws javax.xml.parsers.ParserConfigurationException,
                        java.io.IOException,
                        java.lang.InterruptedException,
                        org.xml.sax.SAXException,
                        java.security.KeyManagementException,
                        java.security.NoSuchAlgorithmException</pre>
<div class="block">Main method. It is invoked is run as a standalone application. A command line argument must
 be passed with the "-config=<configfile>" declaration. A simple wrapper to the <a href="../uid4nps/userid4nps.html#start(java.lang.String[])"><code>start(java.lang.String[])</code></a> method</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - Command line arguments. Mandatory a "-config=<configfile>" argument</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.InterruptedException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.security.KeyManagementException</code></dd></dl>
</li>
</ul>
<a name="start(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre>public static&nbsp;void&nbsp;start(java.lang.String[]&nbsp;args)
                  throws javax.xml.parsers.ParserConfigurationException,
                         java.io.IOException,
                         java.lang.InterruptedException,
                         org.xml.sax.SAXException,
                         java.security.KeyManagementException,
                         java.security.NoSuchAlgorithmException</pre>
<div class="block">The method starting the application. Parses the command line argument and starts
 the Finite State Machine (<a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a>) in the "INIT" state</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - Command line arguments. Mandatory a "-config=<configfile>" argument</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.parsers.ParserConfigurationException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.lang.InterruptedException</code></dd>
<dd><code>org.xml.sax.SAXException</code></dd>
<dd><code>java.security.KeyManagementException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="stop(java.lang.String[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre>public static&nbsp;void&nbsp;stop(java.lang.String[]&nbsp;args)</pre>
<div class="block">Clears the <a href="../uid4nps/userid4nps.html#keepRunning"><code>keepRunning</code></a> flag so <a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a> can gracefully end</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>args</code> - Unused</dd></dl>
</li>
</ul>
<a name="tryNewFile(java.nio.file.Path)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>tryNewFile</h4>
<pre>protected static&nbsp;int&nbsp;tryNewFile(java.nio.file.Path&nbsp;oldFile)
                         throws java.io.IOException</pre>
<div class="block">After ten unsuccessful consecutive tries to read a new line from the <a href="../uid4nps/userid4nps.html#fcNpsLogFile"><code>fcNpsLogFile</code></a>
 we'll review the <a href="../uid4nps/userid4nps.html#npsLogDir"><code>npsLogDir</code></a> directory to see if NPS has rolled up to a new
 log file. In such a case we close the old fine and open <a href="../uid4nps/userid4nps.html#fcNpsLogFile"><code>fcNpsLogFile</code></a> to the newer one.
 
 We use three different strategies to sense a roll over. So it also works with file systems that do not update the timestamp (NTFS in many Windows Server OS)
 <ul>
 <li>Looking for a newer file (from a timestamp point of view). If it doesn't sense a new file then ...</li>
 <li>Looking if there is one, and only one, new ".log" file in the directory (compared to the list of ".log" files from the previous sample). If it doesn't sense a new file then ...</li>
 <li>Looking for the ".log" file that is growing in size</li>
 </ul></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>oldFile</code> - Pointer to the currently opened log file</dd>
<dt><span class="strong">Returns:</span></dt><dd>A <a href="../uid4nps/userid4nps.html#fsm(int)"><code>fsm(int)</code></a> OK transition.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../uid4nps/package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/userid4nps.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../uid4nps/PanosXlmResponseParse.html" title="class in uid4nps"><span class="strong">Prev Class</span></a></li>
<li><a href="../uid4nps/UseridNpsDtsParser.html" title="class in uid4nps"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?uid4nps/userid4nps.html" target="_top">Frames</a></li>
<li><a href="userid4nps.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
